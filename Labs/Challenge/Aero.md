# Aero
## Time
Ini Access = 5.5h  
Privesc = 4h  
Total hour = 9.5h
※iniもprivescもディスコあり

## 教訓
- nmapしたあとにディレクトリスキャンをsmall.txtで再帰的にやるのが大事だった。
- nmapでサービスのバージョン分からなくても、nc -nvすると詳細バージョンが見れたりするのでこれも大事。
- リバースシェルの待ち受けポートを適当に4444にするな。


## Sumarry
1. nmapでポート80が空いているのを確認。ftpはanonymousログインできず。
2. 80にアクセスするとpicoとかいうCMSを使っているのが分かって、これが脆弱かなと思いきやrabbit hall
3. ディレクトリスキャンをFFUFでしていく。この時、使うwordlistsが大事。これをミスると一生Initial Access取れない。/usr/share/wordlists/dirbuster/*.small.txtを使うこと。
4. /apiっていうのが見使うので、これを再帰的にスキャンしてるとそのうちにheartbeatなるエンドポイントが見つかる。
5. heartbeatみると、DBと通信してるぽいことが分かる。
6. これまでnmapしたときに動いてたポートに対してnc -nv <IP> <port>すると、nmapで見えなかったサービスの詳細なバージョンが見える。
7. 某DBサービスのバージョンが見えるので、それでCSVをでぃぐってちょっとExploitを書き換えるとfoothold取れる。この時、ncでシェル取れるけど、アウトバウンドのポートが恐らく制限されてる。ターゲットIPで解放されてるポートをncで待ち受けないとうまくいかん。適当に4444やると一生シェル取れないので注意。
8. シェル取ったらSUIDがついてるファイルを探す。find -perm -u=s -type f 2>/dev/nullでSUIDのついてるファイルを列挙できる。そうするとバージョンが見える怪しいバイナリが見つかる。
9. SUIDついてるバイナリをカレントユーザで実行できればroot実行されるので、脆弱性をでぃぐって発見。
10. Exploitをコンパイルするのが面倒だけど色々がんばるとrootがとれる。
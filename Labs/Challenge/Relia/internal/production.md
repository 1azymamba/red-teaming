# production

1. 他のマシンで手に入れた認証情報を使い、andr*wとしてsshでアクセスする。
2. linpeasを実行して、doaseditなどがあるので、doas.confが怪しそうというあたりをつける。
3. /etc/local/doas.confを確認すると、wheelグループはroot権限のコマンドをすべて実行できること、また、and*ewユーザはapache24サービスをroot権限でdoas経由で実行できることが書いてある。
4. まず、and*ewユーザでapache24サービスをdoasから実行する。
5. Kaliからターゲットホストにブラウザアクセスすると、port80が開いていて、phpのウェブサイトらしきものが動いているのが確認できる。
6. index.htmlのファイルがferoxbusterで見つかるので、findコマンドでターゲットホスト内でどのフォルダがrootディレクトリになっているかを探る。
7. ルートディレクトリが確認出来たら、tmpのフォルダ内であれば書き込み権限があるようなので、その中にphpのリバースシェルをscpとかで配置する。
8. Kaliからリバースシェルにアクセスすると、wwwユーザになっていることがidコマンドによって確認できる。さらにidによって、wwwユーザはwheelグループに一部、つまりdoasによってすべてのコマンドをroot権限で実行できることが分かるので、これでrootに上がって終わり。
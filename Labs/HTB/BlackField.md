# BlackField
## 手順
1. まずはrustscan。ポートは色々開いているが、まずはenum4linux, ldapsearch, nmap --script ldap brurte, kerbruteをぶん回しておく。
2. ぶん回している間に、rpcclientとsmbclientで匿名ログインができないかを試す。どっちもログインは匿名でいけるぽい。
3. smbclientが、ターゲットのディレクトリは見えるのにログインできなくね？となってrpcclientのコマンド試しまくるなどして時間を溶かす。
4. ldapsearchらへんの列挙が終わって確認するも、ユーザ名取得できておらず詰んだくね？となる。
5. smbclientをディグリながらいろいろ試す。どうやらコマンドの指定をミスってたぽい。-Lなしでディレクトリ指定するとanonymous logonでディレクトリを全部ローカルに落とせた。
6. 321?こくらいのディレクトリを落とし、ユーザ名っぽいのでそこからユーザ名のリストを作成する。
7. ユーザリストを作成した後、とりあえずAS-REP Roastingぶっかます。ここで一つだけユーザがヒットする。
8. ユーザのハッシュをhashcatの形式で取れたのでクラックを試す。クラックできる。
9. 1つぶんのユーザ&パスワードを取得できたので、psexec, Kerberoasting, evil-winrmを試すも失敗。まだこのユーザでシェル取れないのかもと思い、とりまsmbclientを子のクレデンシャル使ってもっかいやる。
10. さっきアクセスできなかったSYSVOLに入れるのでそこのディレクトリ全部ローカルに落とす。ちなみにSYSVOLっていうのは[これらしい](https://e-words.jp/w/SYSVOL%E3%83%95%E3%82%A9%E3%83%AB%E3%83%80.html)
11. SYSVOLについてディグっていると、他のDCとの同期やらのためにあったりログオンスクリプトやらグループポリシーの設定ファイルやらがあったりするらしい。クレデンシャルありそうな予感。wkwk
12. まさかのなし。GPPが見つかればAES復号いけたはずなのに。。
13. あきらめてぼーっとして時間を溶かす。パスワードスプレーしてないことを思い出す。smbにnxc使ってさっきクラックしたパスワード使ってみると、smbで同じパスワードを使ってるやつがいた。
14. winrmとldapもnxcしておく。
# Shenzi

## 手順
1. rustscanする。Webポートが怪しいので列挙するが何も出ず。XAMPP使っていることはわかる。
2. ftpのアノニマスログインは失敗。SMBにアノニマスログオン成功。
3. SMBの中でpassword.txtを見つける。Wordpressの管理者ログインのための認証情報を取得。
4. webポートのどこかにwordpressがホストされているはずだがパスが見つからない。shenziというディレクトリの下にホストされているらしく、<IP>/shenzi/とやらないとアクセスできない。ここは完全に推測でこのパスを見つけるしかない。
5. wordpressに管理者としてログイン後、Hello-Dollyとかを書き換えてシェル取得。
6. privesccheckを書けると、**AllwaysInstallElevated**という権限が有効になっていることが分かる。これが有効な場合、.msiというマイクロソフトインストーラを使ってソフトウェアインストールした際に、そのソフトウェアにSYSTEM権限が付与され、.msiはSYSTEM権限で実行されることになる。これが有効だと、すべてのユーザがSYSTEMで.msiを実行できることになる。ちなみにこの権限を有効にすることはMSからも推奨されていない。
7. msfvenomで.msiのペイロードを作ってターゲット上で./payload.msiしたらSYSTEM取れて終わり。
# Client-side Attacksの定義
[verisonのレポート](https://www.verizon.com/business/resources/reports/2022/dbir/2022-data-breach-investigations-report-dbir.pdf)によると、近年では脆弱性を突いて企業内部のNWに侵入するということはより難しくなってきている。  
実際に最も多いのは**資格情報への攻撃**であり、次に**フィッシング**が最初のNW侵入のための足掛かりとされることが多い。  
  
ここで、フィッシングは多くの場合、クライアント側の攻撃を利用する。このタイプの攻撃は、マルウェアをユーザに配信することで機能する。  
  
ターゲットユーザがマシン上でこれらのファイルを実行すると、内部NWへの足掛かりを得ることができる。  
  
これがClient-side Attacksの定義である。  
  
# Client-side Attacksの種類

Client-side Attacksでは、**ブラウザ、OSコンポーネント、オフィスプログラム**といったローカルソフトウェアやアプリケーションの脆弱性や機能を悪用することが多い。  
  
このClient-side Attacksで使われるマルウェアをユーザに配信するメカニズムでは、メールにファイルを添付するだけでなく、**USB Dropping**や**水飲み場攻撃**といった高度なメカニズムを使用することもある。  
  
近年はスパムフィルター、FWといった製品がファイルをスキャンしているため、電子メール経由でペイロードを配信することはますます難しくなってきている。
  
またClient-side Attacksは、基本的にはWebアプリケーションのような外部に公開されているマシンではなく、内部NWの外部からアクセスできない端末に攻撃を仕掛ける必要がある。

# Infomation Gathering
ターゲットの使っているアプリケーションやOSバージョン等の詳細情報を特定することは、これまでのClient-side Attacks以外の攻撃同様非常に重要。  
  
しかしこれまでのように外部から通信は直接できないため、nmapを使うことはできない。  
 
そのような状況下でターゲットクライアントの情報を収集するには、以下のような手法がある。  
1. 公的に入手可能なドキュメントのメタデータタグを調査する  
=>作成者、作成日、ドキュメントの作成に使用したソフトウェアの名前とバージョン、クライアントのOSといった、ドキュメントに関する多くの情報を入手できる可能性がある。  
また、ここでいう公的に入手可能な文書は、**Google Dorks**といった手法で検索して入手することができる。  
さらに、このメタデータの閲覧には[exiftool](OSCP-Cheat-Sheet\Tools\exiftool.md)というものを使用して閲覧することができる。  

> [!Tips]  
> exiftoolでメタタグを確認した時、極力最近の情報を信頼すること。古い情報だとOSなどのバージョンが現在のターゲットの状況と異なる可能性がある。  

## Client Fingerprinting
ここでは、内部NWに存在するターゲットのOSとブラウザの情報を取得する、というシナリオ(デバイスフィンガープリンティングと呼ぶ)というシナリオを考える。  
  
まず攻撃ベクトルの一つとして、ターゲットのメールアドレス宛てにHTAを送付して実行させ、Internet ExplorerもしくあｈMicrosoft Edgeのコンテキストでコードを実行させられる可能性がある。  
  
上記は多くのアクターによって利用される手口だが、これを実行するには、事前にターゲットシステムでWindowsを使っていること、また、Internet ExplorerやEdgeを使用していることが分かっていないといけない。  
  
そのための情報を得るのが、この**Client Fingerprinting**というステップになる。  
  
Client Fingerprintingの取得には、[CanaryTokens](https://canarytokens.org/generate)と呼ばれるWebからリンクを作成して、これをターゲットに訪問させる、という手法がある。  
  
より実用的なCanarytokensの使用方法としては、WordやPDF等のドキュメントにトークンを埋め込むことができるので、それを利用してターゲットにバレずにFingerprintingを行うといった方法がある。